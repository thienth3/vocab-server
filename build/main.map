{"version":3,"sources":["webpack:///webpack/bootstrap 24a0af76d548dedf970f","webpack:///external \"mongoose\"","webpack:///external \"lodash\"","webpack:///external \"dataloader\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"bcryptjs\"","webpack:///external \"dotenv\"","webpack:///./utils/index.js","webpack:///external \"g-i-s\"","webpack:///./event/app.event.js","webpack:///./index.js","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"graphql-depth-limit\"","webpack:///external \"graphql-yoga\"","webpack:///external \"helmet\"","webpack:///external \"passport\"","webpack:///./db/index.js","webpack:///./db/models/Highlight.js","webpack:///./db/models/Reference.js","webpack:///./db/models/User.js","webpack:///./loaders/index.js","webpack:///./loaders/single.js","webpack:///./loaders/multiple.js","webpack:///./loaders/queryLoader.js","webpack:///./resolvers/index.js","webpack:///./resolvers/queries/index.js","webpack:///./resolvers/queries/auth/index.js","webpack:///./resolvers/queries/auth/user.js","webpack:///./resolvers/queries/user/index.js","webpack:///./resolvers/queries/user/currentUser.js","webpack:///./resolvers/queries/vocab/index.js","webpack:///./resolvers/queries/vocab/getAllVocab.js","webpack:///./resolvers/queries/vocab/getOneVocab.js","webpack:///./resolvers/queries/vocab/getFeed.js","webpack:///./resolvers/queries/vocab/references.js","webpack:///./resolvers/queries/vocab/searchImage.js","webpack:///./resolvers/mutations/index.js","webpack:///./resolvers/mutations/auth/index.js","webpack:///./resolvers/mutations/auth/login.js","webpack:///./resolvers/mutations/auth/signup.js","webpack:///./resolvers/mutations/vocab/index.js","webpack:///./resolvers/mutations/vocab/addVocab.js","webpack:///external \"events\"","webpack:///./resolvers/mutations/vocab/addReferenceByPage.js","webpack:///./resolvers/mutations/vocab/removeVocab.js","webpack:///./resolvers/mutations/vocab/setTopVocab.js","webpack:///./resolvers/mutations/vocab/updateVocab.js","webpack:///./resolvers/mutations/user/index.js","webpack:///./resolvers/mutations/user/updateUser.js","webpack:///./resolvers/subscriptions/index.js","webpack:///./types/index.js","webpack:///./types/Auth.js","webpack:///./types/User.js","webpack:///./types/Vocab.js","webpack:///./worker/vocabImage.worker.js"],"names":["initUser","req","Authorization","request","headers","authorization","token","replace","jwt","verify","process","env","AUTH_SECRET","err","decoded","console","log","userId","EventEmitter","require","AppEventConst","addNewVocab","AppEvent","config","path","dev","startServer","initDB","db","pubsub","PubSub","server","GraphQLServer","typeDefs","resolvers","context","loaders","createLoaders","user","validationRules","depthLimit","vocabWorker","express","use","compression","helmet","cookieParser","ONE_YEAR","set","passport","initialize","CLIENT_URL","corsOptions","origin","credentials","port","parseInt","PORT","options","cors","start","mongoose","connect","MONGO_URL","Schema","highlightSchema","creator","type","Types","ObjectId","ref","required","content","String","comment","sentence","paragraph","image","position","url","ip","os","count","Number","default","random","Math","rank","deletedAt","Date","timestamps","module","exports","model","referenceSchema","highlightRef","createdAt","now","updatedAt","userSchema","email","unique","password","select","User","user_ById","single","highlight_ById","reference_By","multiple","queryLoader","Dataloader","objArray","field","ids","map","obj","data","query","$in","result","find","exec","resultById","_","keyBy","id","offset","limit","skip","arrayObject","array","key","JSON","stringify","push","queries","Promise","all","quires","mutations","subscriptions","merge","auth","vocab","AuthPayload","parent","args","userModel","findOne","_id","error","Error","Query","currentUser","ctx","lean","getAllVocab","getOneVocab","getFeed","searchImage","Vocab","references","rq","highlightModel","rs","keySearch","filter","page","size","findObj","$regex","RegExp","sort","referenceModel","load","gis","resolve","reject","opts","searchTerm","results","slice","ex","Mutation","login","signup","valid","bcrypt","compare","undefined","sign","hashedPassword","hash","create","addVocab","removeVocab","addReferenceByPage","updateVocab","setTopVocab","highlight","findOneAndUpdate","upsert","emit","contentInPage","Map","reference","values","where","update","topRankItem","topRank","updateUser","newPassword","modifier","newHashedPassword","new","Subscription","Root","Auth","on","length"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 24a0af76d548dedf970f","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"dataloader\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dataloader\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"bcryptjs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcryptjs\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 5\n// module chunks = 0","import jwt from 'jsonwebtoken'\r\n\r\nexport const initUser = req => {\r\n  const Authorization =\r\n    req.request && req.request.headers && req.request.headers.authorization\r\n      ? req.request.headers.authorization\r\n      : null\r\n  if (Authorization) {\r\n    const token = Authorization.replace('Bearer ', '')\r\n\r\n      return jwt.verify(token, process.env.AUTH_SECRET, (err, decoded) => {\r\n      if (err) {\r\n        console.log('error', err)\r\n        return null\r\n      }\r\n      return decoded.userId\r\n    })\r\n  }\r\n  return null\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./utils/index.js","module.exports = require(\"g-i-s\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"g-i-s\"\n// module id = 7\n// module chunks = 0","const EventEmitter = require('events');\r\n\r\nexport const AppEventConst = {\r\n    addNewVocab: 'addNewVocab'\r\n}\r\n\r\nexport const AppEvent = new EventEmitter();//app event\n\n\n// WEBPACK FOOTER //\n// ./event/app.event.js","require('dotenv').config({\r\n  path: `.env.${process.env.NODE_ENV}`\r\n});\r\n\r\nimport compression from 'compression';\r\nimport cookieParser from 'cookie-parser';\r\nimport depthLimit from 'graphql-depth-limit';\r\nimport { GraphQLServer, PubSub } from 'graphql-yoga';\r\nimport helmet from 'helmet';\r\nimport passport from 'passport';\r\nimport db from './db';\r\nimport createLoaders from './loaders';\r\nimport resolvers from './resolvers';\r\nimport typeDefs from './types';\r\nimport { initUser } from './utils';\r\nimport vocabWorker from './worker/vocabImage.worker'\r\n\r\nconst dev = process.env.NODE_ENV !== 'production';\r\n\r\nconst startServer = async () => {\r\n  const initDB = await db();\r\n\r\n  const pubsub = new PubSub();\r\n\r\n  const server = new GraphQLServer({\r\n    typeDefs,\r\n    resolvers,\r\n    context: async req => ({\r\n      ...req,\r\n      pubsub,\r\n      loaders: createLoaders(),\r\n      user: initUser(req),\r\n      db: initDB\r\n    }),\r\n    validationRules: [depthLimit(10)]\r\n  });\r\n  vocabWorker({\r\n    db: initDB\r\n  });\r\n\r\n  server.express.use(compression());\r\n  server.express.use(helmet());\r\n  server.express.use(cookieParser());\r\n\r\n  const ONE_YEAR = 31556952000;\r\n\r\n  if (!dev) {\r\n    server.express.set('trust proxy', 1);\r\n  }\r\n\r\n  server.express.use(passport.initialize());\r\n\r\n  //todo\r\n  //initGoogleAuth(server.express)\r\n\r\n  console.log('node_env:', process.env.NODE_ENV);\r\n  console.log('client_url:', process.env.CLIENT_URL);\r\n  const corsOptions = {\r\n    origin: process.env.CLIENT_URL,\r\n    credentials: true\r\n  };\r\n\r\n  //option object for graphql yoga\r\n  const port = parseInt(process.env.PORT, 10) || 4000;\r\n  const options = {\r\n    port,\r\n    cors: corsOptions\r\n  };\r\n\r\n  server.start(options, ({ port }) =>\r\n    console.log(\r\n      `Server started, listening on port ${port} for incoming requests. [${process.env.NODE_ENV}]`\r\n    )\r\n  );\r\n};\r\n\r\nstartServer();\r\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"cookie-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cookie-parser\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"graphql-depth-limit\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"graphql-depth-limit\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"graphql-yoga\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"graphql-yoga\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 16\n// module chunks = 0","require('dotenv').config({\r\n  path: `.env.${process.env.NODE_ENV}`\r\n});\r\n\r\nimport mongoose from 'mongoose';\r\nimport './models/Highlight';\r\nimport './models/Reference';\r\nimport './models/User';\r\n\r\nconst dev = process.env.NODE_ENV !== 'production';\r\nif (dev) {\r\n  mongoose.set('debug', true);\r\n}\r\n// Document https://mongoosejs.com/docs/deprecations.html#-findandmodify-\r\nmongoose.set('useFindAndModify', false);\r\n\r\nexport default async () => {\r\n  console.log('connecting to MongoDB');\r\n  return await mongoose.connect(process.env.MONGO_URL);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./db/index.js","const mongoose = require('mongoose');\r\nconst Schema = mongoose.Schema;\r\n\r\nconst highlightSchema = new Schema({\r\n  creator: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'user',\r\n    required: true\r\n  },\r\n  content: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  comment: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  sentence: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  paragraph: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  image: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  position: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  url: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  ip: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  os: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  count: {\r\n    type: Number,\r\n    required: true,\r\n    default: 1\r\n  },\r\n  random: {\r\n    type: Number,\r\n    required: true,\r\n    default: Math.random()\r\n  },\r\n  rank: {\r\n    type: Number,\r\n    required: true,\r\n    default: 0\r\n  },\r\n  deletedAt: {\r\n    type: Date,\r\n    required: false\r\n  }\r\n}, { timestamps: true });\r\n\r\nmodule.exports = mongoose.model('highlight', highlightSchema);\r\n\n\n\n// WEBPACK FOOTER //\n// ./db/models/Highlight.js","const mongoose = require('mongoose');\r\nconst Schema = mongoose.Schema;\r\n\r\nconst referenceSchema = new Schema({\r\n  creator: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'user',\r\n    required: true\r\n  },\r\n  highlightRef: {\r\n    type: mongoose.Schema.Types.ObjectId,\r\n    ref: 'highlight',\r\n    required: true\r\n  },\r\n  content: {\r\n    type: String,\r\n    required: false\r\n  },\r\n  sentence: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  paragraph: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  position: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  url: {\r\n    type: String,\r\n    required: true,\r\n  },\r\n  ip: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  os: {\r\n    type: String,\r\n    required: false,\r\n  },\r\n  createdAt: {\r\n    type: Date,\r\n    required: true,\r\n    default: Date.now\r\n  },\r\n  updatedAt: {\r\n    type: Date,\r\n    required: true,\r\n    default: Date.now\r\n  }\r\n});\r\n\r\nmodule.exports = mongoose.model('reference', referenceSchema);\r\n\n\n\n// WEBPACK FOOTER //\n// ./db/models/Reference.js","import mongoose from 'mongoose';\r\n\r\nconst userSchema = new mongoose.Schema({\r\n  email: {\r\n    type: String,\r\n    required: true,\r\n    unique: true\r\n  },\r\n  createdAt: {\r\n    type: Date,\r\n    required: true,\r\n    default: Date.now\r\n  },\r\n  updatedAt: {\r\n    type: Date,\r\n    required: true,\r\n    default: Date.now\r\n  },\r\n  // Don't return password unless specified to\r\n  password: {\r\n    type: String,\r\n    select: false\r\n  }\r\n});\r\n\r\nconst User = mongoose.model('user', userSchema);\r\n\r\nexport default User;\r\n\n\n\n// WEBPACK FOOTER //\n// ./db/models/User.js","import single from './single';\r\nimport multiple from './multiple';\r\nimport queryLoader from './queryLoader';\r\n\r\nexport default () => ({\r\n  // make unique dataloaders - else Cache problem can occur\r\n\r\n  user_ById: single(),\r\n  highlight_ById: single(),\r\n  reference_By: multiple(),\r\n  queryLoader: queryLoader()\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./loaders/index.js","import Dataloader from 'dataloader'\r\nimport _ from 'lodash'\r\n\r\nexport default () =>\r\n  new Dataloader(async objArray => {\r\n    const model = objArray[0].model\r\n    const field = objArray[0].field\r\n\r\n    const ids = objArray.map(obj => obj.data)\r\n\r\n    let query = {}\r\n    query[field] = { $in: ids }\r\n    const result = await model.find(query).exec()\r\n\r\n    const resultById = _.keyBy(result, '_id')\r\n    return ids.map(id => resultById[id])\r\n  })\r\n\n\n\n// WEBPACK FOOTER //\n// ./loaders/single.js","import Dataloader from 'dataloader'\r\nimport _ from 'lodash'\r\n\r\nexport default () =>\r\n  new Dataloader(async objArray => {\r\n    //console.log(objArray)\r\n    const model = objArray[0].model\r\n    const field = objArray[0].field\r\n    let offset\r\n    let limit\r\n    if (objArray[0].options) {\r\n      offset = objArray[0].options.offset || ''\r\n      limit = objArray[0].options.limit || ''\r\n    }\r\n\r\n    const ids = objArray.map(obj => obj.data)\r\n\r\n    let query = {}\r\n    query[field] = { $in: ids }\r\n    const result = await model\r\n      .find(query)\r\n      .skip(offset)\r\n      .limit(limit)\r\n      .exec()\r\n\r\n    const resultById = _.keyBy(result, '_id')\r\n\r\n    const arrayObject = ids.map(id => {\r\n      let array = []\r\n\r\n      for (let key in resultById) {\r\n        let obj = resultById[key]\r\n\r\n        if (JSON.stringify(obj[field]) === JSON.stringify(id)) {\r\n          array.push(obj)\r\n        }\r\n      }\r\n      return array\r\n    })\r\n\r\n    return arrayObject\r\n  })\r\n\n\n\n// WEBPACK FOOTER //\n// ./loaders/multiple.js","import Dataloader from 'dataloader'\r\nimport _ from 'lodash'\r\n\r\nexport default () =>\r\n  new Dataloader(async queries => {\r\n    return Promise.all(queries.map(async query => await query()))\r\n  })\r\n\n\n\n// WEBPACK FOOTER //\n// ./loaders/queryLoader.js","import quires from './queries';\r\nimport mutations from './mutations';\r\nimport subscriptions from './subscriptions';\r\n\r\nexport default {\r\n  ...quires,\r\n  ...mutations,\r\n  ...subscriptions\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/index.js","import { merge } from 'lodash';\r\nimport auth from './auth';\r\nimport user from './user';\r\nimport vocab from './vocab';\r\n\r\n// use merge here to avoid overriding\r\nexport default merge(user, auth, vocab);\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/index.js","import user from './user'\r\n\r\nexport default {\r\n  AuthPayload: {\r\n    user\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/auth/index.js","export default async (parent, args, { loaders, db }) => {\r\n  try {\r\n    const userModel = db.model('user')\r\n    return await userModel.findOne({ _id: parent.user })\r\n  } catch (error) {\r\n    throw new Error(error)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/auth/user.js","import currentUser from './currentUser';\r\n\r\nexport default {\r\n  Query: {\r\n    currentUser\r\n  },\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/user/index.js","import { getUserId } from '../../../utils'\r\n\r\nexport default async (parent, args, ctx) => {\r\n  try {\r\n    if (!ctx.user) throw new Error('Not authenticated')\r\n\r\n    const user = ctx.db.model('user')\r\n    return await user.findOne({ _id: ctx.user }).lean()\r\n  } catch (error) {\r\n    throw new Error(error)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/user/currentUser.js","import getAllVocab from './getAllVocab';\r\nimport getOneVocab from './getOneVocab';\r\nimport getFeed from './getFeed';\r\nimport references from './references';\r\nimport searchImage from './searchImage';\r\n\r\nexport default {\r\n  Query: {\r\n    getAllVocab,\r\n    getOneVocab,\r\n    getFeed,\r\n    searchImage\r\n  },\r\n  Vocab: {\r\n    references\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/vocab/index.js","export default async (parent, rq, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  const highlightModel = ctx.db.model('highlight');\r\n  return highlightModel.find({\r\n    creator: ctx.user,\r\n    deletedAt: null\r\n  }).lean();\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/vocab/getAllVocab.js","export default async (parent, { content }, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  const highlightModel = ctx.db.model('highlight');\r\n  let rs = await highlightModel.findOne({\r\n    creator: ctx.user, content\r\n  }).lean();\r\n  return rs;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/vocab/getOneVocab.js","export default async (parent, {keySearch, filter = 1, page = 0, size = 20}, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  const highlightModel = ctx.db.model('highlight');\r\n\r\n  // console.log(query, 11);//todo fix limit and count\r\n  let findObj = {\r\n    creator: ctx.user,\r\n    deletedAt: null\r\n  };\r\n  if (keySearch) {\r\n    // query = query.find({ content: { $regex: new RegExp(keySearch, 'i') } })\r\n    findObj.content = { $regex: new RegExp(keySearch, 'i') };\r\n  }\r\n  let query = highlightModel.find(findObj);\r\n\r\n  query = query.limit(size)\r\n  .skip(size * page);\r\n\r\n  if (filter == 1) {//order by date\r\n    query = query\r\n      .sort( { createdAt: -1 });\r\n  }\r\n  if (filter == 2) {// most\r\n    query = query\r\n      .sort( { count: -1 });\r\n  }\r\n\r\n  if (filter == 3) {// random\r\n    query = query\r\n      .sort( { random: -1 });\r\n  }\r\n  \r\n  return query.lean();\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/vocab/getFeed.js","export default async (data, args, { loaders, db }) => {\r\n  try {\r\n    const referenceModel = db.model('reference');\r\n    return loaders.reference_By.load({\r\n      data: data._id,\r\n      model: referenceModel,\r\n      field: 'highlightRef'\r\n    });\r\n  } catch (error) {\r\n    throw new Error(error);\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/vocab/references.js","const gis = require('g-i-s');\r\n// const GSR = require('google-search-results-nodejs');\r\n// const client = new GSR.GoogleSearchResults(\"AIzaSyCn4JeRdRyZLUiBcVj-dpLRdNh6bN5_WeE\")\r\n\r\n// todo increase performance seach\r\nexport default async (parent, { content }, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  let rs = await (new Promise((resolve, reject) => {\r\n    try {\r\n      var opts = {\r\n        searchTerm: content//,\r\n        // queryStringAddition: '&tbs=isz:m'\r\n      };\r\n      gis(opts, (error, results) => {\r\n        if (error) {\r\n          reject(error);\r\n        }\r\n        else {\r\n          resolve((results || []).slice(0, 30));\r\n        }\r\n      });\r\n    } catch(ex) {\r\n      reject(ex);\r\n    }\r\n  }));\r\n \r\n  return rs;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/queries/vocab/searchImage.js","import auth from './auth';\r\nimport vocab from './vocab';\r\nimport user from './user';\r\nexport default {\r\n  Mutation: {\r\n    ...auth,\r\n    ...user,\r\n    ...vocab,\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/index.js","import login from './login'\r\nimport signup from './signup'\r\n\r\nexport default {\r\n  login,\r\n  signup\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/auth/index.js","import bcrypt from 'bcryptjs'\r\nimport jwt from 'jsonwebtoken'\r\n\r\nexport default async (_, { email, password }, ctx) => {\r\n  try {\r\n    const userModel = ctx.db.model('user')\r\n    const user = await userModel.findOne({ email }, { password: 1 }).lean()\r\n    if (!user) {\r\n      return new Error('No such user found')\r\n    }\r\n\r\n    const valid = await bcrypt.compare(password, user.password)\r\n    if (!valid) {\r\n      return new Error('Invalid password')\r\n    }\r\n\r\n    // remove password from user object to limit scope (security)\r\n    user.password = undefined\r\n\r\n    const token = jwt.sign({ userId: user._id }, process.env.AUTH_SECRET)\r\n\r\n    return {\r\n      token,\r\n      user\r\n    }\r\n  } catch (err) {\r\n    return new Error(err)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/auth/login.js","import bcrypt from 'bcryptjs'\r\nimport jwt from 'jsonwebtoken'\r\n\r\nexport default async (_, { email, password }, ctx) => {\r\n  try {\r\n    const userModel = ctx.db.model('user')\r\n\r\n    let user = await userModel.findOne({ email }).lean()\r\n\r\n    if (user) {\r\n      throw new Error('Email is already taken')\r\n    }\r\n\r\n    const hashedPassword = await bcrypt.hash(password, 10)\r\n    user = await userModel.create({\r\n      email,\r\n      password: hashedPassword,\r\n    })\r\n\r\n    const token = jwt.sign({ userId: user._id }, process.env.AUTH_SECRET)\r\n\r\n    return { token, user }\r\n  } catch (err) {\r\n    throw new Error(err)\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/auth/signup.js","import addVocab from './addVocab';\r\nimport addReferenceByPage from './addReferenceByPage';\r\nimport removeVocab from './removeVocab';\r\nimport setTopVocab from './setTopVocab';\r\nimport updateVocab from './updateVocab';\r\n\r\nexport default {\r\n  addVocab,\r\n  removeVocab,\r\n  addReferenceByPage,\r\n  updateVocab,\r\n  setTopVocab\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/vocab/index.js","import { AppEvent, AppEventConst } from './../../../event/app.event';\r\n\r\nexport default async (parent, { content, comment, sentence, paragraph,\r\n  image, position, url }, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n\r\n  const highlightModel = ctx.db.model('highlight');\r\n  let highlight = await highlightModel.findOneAndUpdate({ \r\n      creator: ctx.user, content\r\n    },\r\n    { \r\n      creator: ctx.user, content, comment, sentence, paragraph,\r\n      image, position, url\r\n    }, {\r\n    upsert: true\r\n  });\r\n  //emit event \r\n  console.log('addNewVocabemit----------------->>>');\r\n  AppEvent.emit(AppEventConst.addNewVocab, { content, creator: ctx.user });\r\n  if (!highlight) {\r\n    highlight = await highlightModel.findOne({\r\n      creator: ctx.user, content\r\n    }).lean();\r\n  }\r\n  console.log(highlight, 111);\r\n  return highlight;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/vocab/addVocab.js","module.exports = require(\"events\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"events\"\n// module id = 43\n// module chunks = 0","export default async (parent, { references, url}, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  \r\n  const referenceModel = ctx.db.model('reference');\r\n  const highlightModel = ctx.db.model('highlight');\r\n  let contentInPage = new Map();\r\n  for (let ref of references) {\r\n    let rs = await highlightModel.findOne({\r\n      creator: ctx.user, content: ref.content\r\n    }).lean();\r\n    contentInPage.set(ref.content, ref.content);\r\n    let reference = await referenceModel.findOneAndUpdate({ \r\n      creator: ctx.user, sentence: ref.sentence, url,\r\n      content: ref.content\r\n    },\r\n    { \r\n      creator: ctx.user,\r\n      content: ref.content, \r\n      sentence: ref.sentence, \r\n      paragraph: ref.paragraph, \r\n      position: ref.position, \r\n      url: url,\r\n      highlightRef: rs._id\r\n    }, {\r\n      upsert: true\r\n    });\r\n  }\r\n  // update count in highlight\r\n  console.log('contentInPage.values()', contentInPage.values())\r\n  for (let content of contentInPage.values()) {\r\n    let count = await referenceModel.find({\r\n      creator: ctx.user,\r\n      content: content\r\n    }).count();\r\n    await highlightModel.where({ \r\n      creator: ctx.user, content\r\n    }).update({ count: count, random: Math.random() })\r\n  }\r\n\r\n  return true;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/vocab/addReferenceByPage.js","export default async (parent, { content }, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  \r\n  const highlightModel = ctx.db.model('highlight');\r\n  // const referenceModel = ctx.db.model('reference');\r\n  await highlightModel.findOneAndUpdate({ creator: ctx.user, content }, {\r\n    deletedAt: new Date()\r\n  });\r\n  // await referenceModel.findOneAndRemove({ creator: ctx.user, content });\r\n  \r\n  return true;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/vocab/removeVocab.js","export default async (parent, { content }, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n  \r\n  const highlightModel = ctx.db.model('highlight');\r\n  let topRankItem = highlightModel.findOne({ creator: ctx.user }).sort( { rank: -1 });;\r\n  \r\n  if (topRankItem.content == content) return true;\r\n\r\n  let topRank = topRankItem.rank + 1;\r\n  await highlightModel.update({ creator: ctx.user, content}, {\r\n    rank: topRank\r\n  });\r\n  \r\n  return true;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/vocab/setTopVocab.js","export default async (parent, { content, comment, image}, ctx) => {\r\n  if (!ctx.user) {\r\n    throw new Error('You must be logged in');\r\n  }\r\n\r\n  const highlightModel = ctx.db.model('highlight');\r\n  let data = {comment, image};\r\n  // if (image) {\r\n  //   data.image = image;\r\n  // }\r\n  await highlightModel.update({ \r\n      creator: ctx.user, content\r\n    }, data);\r\n  \r\n  return await highlightModel.findOne({\r\n    creator: ctx.user, content\r\n  }).lean();\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/vocab/updateVocab.js","import updateUser from './updateUser'\r\n\r\nexport default {\r\n  updateUser\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/user/index.js","import bcrypt from 'bcryptjs';\r\n\r\nexport default async (\r\n  parent,\r\n  { email, password, newPassword },\r\n  ctx\r\n) => {\r\n  try {\r\n    if (!ctx.user) throw new Error('Not authenticated');\r\n\r\n    const userModel = ctx.db.model('user');\r\n\r\n    let user = await userModel\r\n      .findOne({ _id: ctx.user }, { password: 1 })\r\n      .lean();\r\n    if (!user) {\r\n      return new Error('No such user found');\r\n    }\r\n\r\n    const modifier = {};\r\n\r\n    if (password) {\r\n      const valid = await bcrypt.compare(password, user.password);\r\n      if (!valid) {\r\n        return new Error('Invalid password');\r\n      }\r\n\r\n      if (newPassword) {\r\n        const newHashedPassword = await bcrypt.hash(newPassword, 10);\r\n        modifier.password = newHashedPassword;\r\n      } else {\r\n        return new Error('You have to come up with a new password');\r\n      }\r\n    }\r\n\r\n    if (email) {\r\n      modifier.email = email;\r\n    }\r\n\r\n    modifier.updatedAt = new Date();\r\n\r\n    user = await userModel.findOneAndUpdate({ _id: ctx.user }, modifier, {\r\n      new: true\r\n    });\r\n\r\n    return user;\r\n  } catch (error) {\r\n    throw new Error(error);\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/mutations/user/updateUser.js","export default {\r\n  Subscription: {}\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./resolvers/subscriptions/index.js","import Auth from './Auth';\r\nimport User from './User';\r\nimport Vocab from './Vocab';\r\n\r\nconst Root = /* GraphQL */ `\r\n  # The dummy queries and mutations are necessary because\r\n  # graphql-js cannot have empty root types and we only extend\r\n  # these types later on\r\n  # Ref: apollographql/graphql-tools#293\r\n  scalar JSON\r\n  scalar JSONObject\r\n  type Query {\r\n    dummy: String\r\n  }\r\n  type Mutation {\r\n    dummy: String\r\n  }\r\n  type Subscription {\r\n    dummy: String\r\n  }\r\n  schema {\r\n    query: Query\r\n    mutation: Mutation\r\n    subscription: Subscription\r\n  }\r\n`;\r\n\r\nexport default [Root, User, Auth, Vocab];\r\n\n\n\n// WEBPACK FOOTER //\n// ./types/index.js","export default /* GraphQL */ `\r\n\r\nextend type Mutation {\r\n  signup(email: String!, password: String!): AuthPayload\r\n  login(email: String!, password: String!): AuthPayload\r\n}\r\n\r\ntype AuthPayload {\r\n  token: String\r\n  user: User\r\n}\r\n`\r\n\n\n\n// WEBPACK FOOTER //\n// ./types/Auth.js","export default /* GraphQL */ `\r\n  type User {\r\n    _id: ID!\r\n    email: String!\r\n    createdAt: String!\r\n    updatedAt: String!\r\n  }\r\n\r\n  extend type Query {\r\n    currentUser: User!\r\n  }\r\n\r\n  extend type Mutation {\r\n    updateUser(\r\n      email: String\r\n      password: String\r\n      newPassword: String\r\n    ): User!\r\n  }\r\n`;\r\n\n\n\n// WEBPACK FOOTER //\n// ./types/User.js","export default /* GraphQL */ `\r\n  type Vocab {\r\n    _id: ID\r\n    content: String\r\n    comment: String\r\n    sentence: String\r\n    paragraph: String\r\n    image: String\r\n    position: String\r\n    url: String\r\n    references: [Reference]\r\n  }\r\n  \r\n  type Feed {\r\n    _id: ID\r\n    content: String\r\n    comment: String\r\n    sentence: String\r\n    paragraph: String\r\n    image: String\r\n    position: String\r\n    url: String\r\n    count: Int\r\n  }\r\n\r\n  type Reference {\r\n    content: String\r\n    sentence: String\r\n    paragraph: String\r\n    position: String\r\n  }\r\n  \r\n  type GImage {\r\n    url: String\r\n    width: String\r\n    height: String\r\n  }\r\n  \r\n  input ReferenceInput {\r\n    content: String\r\n    sentence: String\r\n    paragraph: String\r\n    position: String\r\n  }\r\n\r\n  extend type Query {\r\n    getAllVocab: [Vocab]\r\n    getFeed(keySearch: String, filter: Int, page: Int, size: Int): [Feed]\r\n    getOneVocab(content: String!): Vocab\r\n    searchImage(content: String!): [GImage]\r\n  }\r\n\r\n  extend type Mutation {\r\n    addVocab(content: String!\r\n      comment: String\r\n      sentence: String!\r\n      paragraph: String!\r\n      image: String\r\n      position: String!\r\n      url: String!): Vocab!\r\n    updateVocab(content: String!\r\n      comment: String\r\n      image: String): Vocab!\r\n    addReferenceByPage(references: [ReferenceInput!], url: String!): Boolean\r\n    removeVocab(content: String!): Boolean\r\n    setTopVocab(content: String!): Boolean\r\n  }\r\n`;\r\n\n\n\n// WEBPACK FOOTER //\n// ./types/Vocab.js","import { AppEvent, AppEventConst } from './../event/app.event'\r\nconst gis = require('g-i-s');\r\n\r\nexport default ({db}) => {\r\n    console.log('addNewVocab1-----------------');\r\n    AppEvent.on(AppEventConst.addNewVocab, ({content, creator}) => {\r\n        // search image\r\n        console.log('addNewVocab-----------------', content, creator);\r\n        var opts = {\r\n            searchTerm: content//,\r\n            // queryStringAddition: '&tbs=isz:m'\r\n          };\r\n          gis(opts, async (error, results) => {\r\n            if (!error && results.length > 0) {\r\n                // update db\r\n                console.log('results[0].url>>>>>>>>>>>>>>', results[0].url);\r\n                const highlightModel = db.model('highlight');\r\n                await highlightModel.update({ \r\n                    creator, content\r\n                    }, {\r\n                        image: results[0].url\r\n                    });\r\n            }\r\n          });\r\n    })\r\n}\n\n\n// WEBPACK FOOTER //\n// ./worker/vocabImage.worker.js"],"sourceRoot":""}